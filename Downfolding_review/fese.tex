%\subsection{FeSe diatomic molecule (NE-DMD)}
\subsection{FeSe diatomic molecule}
\label{subsection:fese}
Transition metal systems are often difficult to model due to the additional orbital and possibly magnetic degrees of freedom introduced by $d$ electrons.
Models containing all of these degrees of freedom are unwieldy, yet it is difficult to determine which degrees of freedom are needed for a minimal model to reproduce an interesting effect.
Transition metal oxide systems are challenging to describe using most electronic structure methods because of the strong electron correlations and multiple oxidation states possible in these systems. 
Fixed node DMC has been shown to be a highly accurate method on transition metal oxide materials, where it has been shown to improve the description of the ground state properties and energy gaps~\cite{Foyevtsova2014, Wagner_Abbamonte, Zheng2015, Wagner2016}. % for the types of orbital excitations used to sample the Hilbert space.
\BDB{This sentence might be unnecessary:[[[}
However, fixed-node DMC calculations currently cannot access excited state information without advanced knowledge of the symmetries of the state, and are too expensive to access the length and energy scales required for some phenomena, such as superconductivity. 
\BDB{]]]}
Additionally, fixed-node DMC calculations alone cannot yet not quantitatively assess the importance of various degrees of freedom.

In this section, we apply DMD to quantify the importance of interaction parameters in a FeSe diatomic molecule with a bond length equal to that of the iron based superconductor, FeSe~\cite{kumar_crystal_2010}.
To our knowledge, this FeSe diatom does not exist in nature, but nevertheless serves as a simple illustration of a model for the interaction between a transition metal and a ligand. 

The states sampled consisted of singles and doubles excitations from PBE0 calculations with total spin 0, 2, and 4, which were then relaxed via a DMC projection.
233 states fit within an energy window of 8 eV from the ground state, and were selected as the low energy space.
Eight states within the window are not considered because the sum of all occupation descriptors was more than 0.5 less than the number of electrons.
These states have a significant iron $4p$ component relative to the ground state. 
Rather than including descriptors associated with the iron $4p$ orbitals, we assume this indicates that these states carry a component outside the low energy space. 
This is equivalent to assuming that the eigenstates included in $\mathcal{L}$ do not have a significant Fe-$4p$ component.
\lucas{why are we ok excluding them?} \BDB{Does this answer this properly? if not, we can discuss}

We consider a set of 21 possible descriptors consisting of local operators on one iron $4s$, five iron $3d$ states, and three selenium $4p$ states.
We use the same IAO construction as Sec.~\ref{subsection:1dhydrogen} to generate the basis for these operators.
We consider orbital energy descriptors: 
\begin{align*}
  &\epsilon_{s} n^s,&
  &\epsilon_{\pi,\mathrm{Se}} (n^{p_x} + n^{p_y}), &
  &\epsilon_{z} n^{p_z},&
  \\
  &\epsilon_{z^2} n^{d_{z^2}},& 
  &\epsilon_{\pi,\mathrm{Fe}} (n^{d_{xz}} + n^{d_{yz}}).& 
  &\epsilon_{\delta} (n^{d_{xy}} + n^{d_{x^2-y^2}}),&
\end{align*}
We also consider the symmetry-allowed hopping terms:
\begin{align*}
  &t_{\sigma,d} \sum_{\eta} \left( c_{d_{z^2},\eta}^{\dagger} c_{p_z,\eta} + \text{h.c.} \right),&
  &t_{\sigma,s} \sum_{\eta} \left(c_{s,\eta}^{\dagger}  c_{p_z,\eta} + \text{h.c.} \right),&
  &t_{\pi} \sum_{\eta} \left(c_{d_{xz},\eta}^{\dagger}  c_{p_x,\eta} + c_{d_{yz},\eta}^{\dagger}  c_{p_y,\eta} + \text{h.c.} \right).&
\end{align*}
As before, $\eta$ represents the spin index.
We consider Hubbard interactions:
\begin{align*}
  &U_p \sum_{i \in P} n^{i,\uparrow} n^{i,\downarrow},&
  &U_{d,\delta} \sum_{i=d_{xy},d_{x^2-y^2}} n^{i,\uparrow} n^{i,\downarrow},&
  \\
  &U_d \sum_{i \in D} n^{i,\uparrow} n^{i,\downarrow},&
  &U_{d,\pi} \sum_{i=d_{xz},d_{yz}} n^{i,\uparrow} n^{i,\downarrow},&
  &U_{d_{z^2}} n^{d_{z^2},\uparrow} n^{d_{z^2},\downarrow},&
\end{align*}
where $P$ refers to the Se-$4p$ orbitals and $D$ refers to the Fe-$3d$ orbitals. 
We also consider Hund coupling terms for the iron atom:
\begin{align*}
  &J \sum_{i\ne j} S_i \cdot S_j,&
  &J_{\delta} S_{d_{xy}} \cdot S_{d_{x^2-y^2}},&
  &J_{\delta,d_{z^2}} (S_{d_{xy}} + S_{d_{x^2-y^2}}) \cdot S_{d_{z^2}},&
  \\
  &J_{\pi} S_{d_{xz}} \cdot S_{d_{yz}},&
  &J_{\pi,d_{z^2}} (S_{d_{xz}} + S_{d_{yz}}) \cdot S_{d_{z^2}}.&
  &J_{\pi,\delta} (S_{d_{xz}} + S_{d_{yz}}) \cdot (S_{d_{xy}} + S_{d_{x^2-y^2}}),&
\end{align*}
We also considered a nearest neighbor Hubbard interaction: $V \sum_{i\in P, j\in D} n^{i} n^j$.

To generate a minimal description of the system, we employed a matching pursuit (MP) method~\cite{MP_Zhang1993}.
This greedy algorithm builds a model by including parameters one by one, and considering the error of each model as parameters are included.
It starts by choosing the descriptor with the largest correlation coefficient, which in this case is the Hund coupling, $J$.
It then examines the residuals of the model with this descriptor and an overall energy shift: the difference between $E[\Psi_i]$ and the energy produced by the model $H_{eff} = E_0 + J \sum_{i\ne j}S_i \cdot S_j$ for each $|\Psi_i\rangle$ in the sample set.
Next, it includes the parameter that correlates most strongly with the residuals of this first minimal model, and continues in this manner until some convergence criteria is met.
Thus, with this procedure, it is possible to systematically step from a minimal description to an accurate description of the full \textit{ab inito} space.

Applying matching pursuit to the FeSe diatomic molecule produces the following model:
\begin{align}
  H 
  &=
  \epsilon_{\delta,\mathrm{Fe}} (n^{d_{xy}} + n^{d_{x^2-y^2}})
  +
  \epsilon_s n^{s}
  +
  \epsilon_{z} n^{p_z}
  \nonumber \\
  &+ 
  t_{\sigma,d} \sum_{\eta} \left( d_{z^2,\eta}^{\dagger} p_{z,\eta} + \text{h.c.} \right)
  +
  t_{\sigma,s} \sum_{\eta} \left(s_{\eta}^{\dagger}  p_{z,\eta} + \text{h.c.} \right)
  \nonumber \\
  &+
  U_d \sum_{i \in D} n^{d}_{i,\uparrow} n^{d}_{i,\downarrow} 
  +
  J \sum_{\substack{i\ne j \\i,j \in D}} S_i \cdot S_j
  +
  E_0. \label{eq:fesemodel}
\end{align}
As before, $\eta$ is the spin index and $i$ is the orbital index, and $D$ is the set of iron $3d$ orbitals, as above.
$E_0$ is an overall energy shift, also included as a fit parameter.
\lucas{clarify notation. There are some orbitals in superscripts. some in subscripts. Should be $\hat{n}'s$. }
\BDB{I fixed most of this, but the hat notation isn't used in the rest of the paper, so I didn't use it here}
For this demonstration we chose to stop including parameters when the RMS error drops by less than 0.05 eV.
This criterion was chosen to strike a balance between the complexity of the model and the accuracy in reproducing the sample set.
The final RMS error for the model above is 0.61 eV.
All previous parameters may change at each step because the entire model is refitted in each iteration.
The parameters are smoothly varying with the inclusion of new parameters, and they take the correct signs based on symmtery (where applicable). 

\lucas{Why did we stop there? There are much better ways like I mentioned before like test/training, even something like BIC is better.} 
\BDB{
  I tried to justify it a bit more.
  As to why I don't use those other criteria, we actually discussed this a bit a few weeks ago: 
  after this point, the additional Hund's parameters enter, and are difficult to interpret. 
  I've checked the BIC and that measure suggests to add more parameters; I'm pretty sure the test/training will agree. 
  The reason I stopped here is model complexity rather than overfitting.
  If I add all the parameters that improve the fit (according to BIC, for instance), the model will be huge and difficult to understand, and I think this detracts from our point about finding the minimal description. 
  I agree the tolerances feel like they are pulled out of a hat, but I'm unsure what to say if I don't want to get into dicussing the properties of the more complex model.
}

\BDB{I tried to be more precise with this paragraph}

We now turn to quantifying the relative importance of each of the parameters for a minimal model.
Note that the magnitudes of each parameter do not necessarily suggest they affect the properties of the model.
Large parameters may be insignificant if most states in $\mathcal{L}E$ take small values of that descriptor.
Instead, the correlation coefficients between the energy or residuals and each descriptor is a quantitative measure of the utility of that descriptor for that step.
At MP each step, the next parameter added will reduce the error the most from the previous step, compared to the other parameters considered~\cite{MP_Zhang1993}.\BDB{should check that I interpreted this correctly.}
For this system, $J$ is selected first, and most accurate two parameter (including $E_0$) minimal model for the system would be $H_\text{minimal} = E_0 + J_d \sum_i S_i \cdot S_j$. 
The relevance of Hund coupling is consistent with the several studies in the literature, which find a prominent Hund coupling can explain some of the properties of bulk FeSe.~\cite{demedici_hunds_2011,de_medici_janus-faced_2011,georges_strong_2013,busemeyer_competing_2016}.
\BDB{Probably unnecessary [[[}Additionally, excluding $J$ from the final model increases the error to 0.75 eV, and descriptor multiplying $J$ has a correlation coefficient with the residuals of -0.45.\BDB{]]]}
The next chosen parameter is the $t_{\sigma,d}$, with the interpretation that adding this hopping term to $H_\text{minimal} = E_0 + J_d \sum_i S_i \cdot S_j$ will decrease the error more than any other parameter. 
Similarly each new parameter decreases the error the most from the previous step.
Note that this greedy algorithm does not necessary produce the best model for a set number of parameters.
We could, for example, try all 116,280 combinations of 7 parameters from our set of 21 possible parameters and potentially find a lower error.
However, the correlation coefficient provides a simple way to quantify the importance of the possible set of degrees of freedom and therefore generate minimal models.

\begin{figure*}
  \centering
  \includegraphics[width=0.8\textwidth]{./Figures/fese.eps}
  \caption{
    \label{fig:fese} 
    (Left) Parameter values for each fit generated in the MP algorithm, labeled at the step where they are included in the model. 
    A zero value indicates that parameter is not yet added to the model.
    The sign of $J$ is consistent with Hund's rules, and the signs of $t_{\sigma,d}$ and $t_{\sigma,s}$ are consistent with Se being located in positive $z$ with respect to Fe. 
    The $\epsilon_i$ states adjust the energies of the single particle orbitals relative to the energy of the other orbitals.
    (Right) RMS error of each model generated by MP as the algorithm includes parameters. 
  }
\end{figure*}


